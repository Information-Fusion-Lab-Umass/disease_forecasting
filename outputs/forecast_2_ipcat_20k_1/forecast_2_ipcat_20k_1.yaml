# Experiment
exp_id: forecast_2_ipcat_20k_1
output_dir: &output ../outputs
train_model: True
test_model: True   

# Data
data:
    path_load: ../data/data_tadpole_2.pickle
    path_meta: ../data/metadata
    path_images: ../../../ADNI_data/data
    path_feat: ../data/features.csv
    min_visits: 2

datagen:
    data_split: &data_split 0.8
    batch_size: &bsize 128
    num_visits: &T -1
    feat_flag: &imgType tadpole 

# Model 
model:
    load_model: '' #'../outputs/clf_2_featcat_20k_wt3_1/checkpoints/model.pth'
    num_classes: &numcls 2
    class_wt: [1, 5.3]
    module_image:
        name: tadpole2 #multimodal1
        num_input: 699 #692
        num_output: 500
    module_temporal: 
        name: rnn
        num_input: 500
        num_timesteps: *T 
    module_forecast:
        name: append_time
    module_task:
        name: dx1
        num_input: 505
        num_classes: *numcls
    fusion: concat_input #concat_feature

# Train 
train:
    num_epochs: 20000
    save_model: True

# Test
test:
    task: forecast
    data_split: *data_split
    batch_size: *bsize
    feat_flag: *imgType

